<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Redirecting...</title>
  <script>
    // Переменная будет доступна глобально
    var redirectUrl;

    window.onload = function() {
      // Параметры для подстановки
      var name = new URLSearchParams(window.location.search).get("entry.27396987");
      var email = new URLSearchParams(window.location.search).get("entry.728400166");

      // Логирование значений для отладки
      console.log("Name: " + name);
      console.log("Email: " + email);

      // Проверка, что данные получены корректно
      if (name && email) {
        // Формирование URL с предзаполненными данными
        redirectUrl = "https://docs.google.com/forms/d/e/1FAIpQLSf2OejA2QxX64NMIW4C1f-lo5xEvJTfeNkp6St_u5l5OfzPQA/viewform?usp=pp_url&entry.27396987=" + encodeURIComponent(name) + "&entry.728400166=" + encodeURIComponent(email);
        
        // Логирование сформированного URL
        console.log("Redirect URL: " + redirectUrl);
        
        // Перенаправление
        window.location.href = redirectUrl;
      } else {
        // Если данные не были получены, показать ошибку
        console.error("Error: Missing name or email parameters.");
      }
    };
  </script>
</head>
<body>
  <h1>Redirecting...</h1>
  <p>If you are not redirected, <a href="#" id="redirectLink">click here</a>.</p>

  <script>
    // Если пользователь не перенаправлен автоматически, клик по ссылке
    document.getElementById('redirectLink').onclick = function() {
      if (redirectUrl) {
        window.location.href = redirectUrl;
      } else {
        console.error("Redirect URL is not defined.");
      }
    };
  </script>
</body>
</html>
